using Gtk 4.0;
using Adw 1;

template $BzFlathubPage: Adw.Bin {
 child: Adw.ViewStack stack {
   enable-transitions: true;
   transition-duration: 400;

   Adw.ViewStackPage {
     name: "empty";
     title: _("Empty");

     child: Adw.StatusPage {
       icon-name: "flatpak-symbolic";
       title: _("Flathub Not Added");
       description: _("The Flathub remote was not found on any of your flatpak installations");
     };
   }
   
   Adw.ViewStackPage {
     name: "content";
     title: _("Browser");

     child: ScrolledWindow {
       styles [
         "transparent"
       ]

       hscrollbar-policy: never;

       child: Adw.ClampScrollable {
         maximum-size: 1500;
         tightening-threshold: 1400;

         child: Viewport {
           child: Box {
             margin-start: 25;
             margin-end: 25;
             margin-top: 20;
             margin-bottom: 20;
             orientation: vertical;
             spacing: 15;

             $BzFeaturedCarousel {
                margin-start:8;
                margin-end:8;
                styles [
                  "flathub-page-section",
                ]
                margin-top: 16;
                hexpand: true;
                model: bind template.state as <$BzFlathubState>.apps_of_the_day_week;
                group-clicked => $featured_carousel_group_clicked_cb(template);
              }

             Box {
               orientation: vertical;
               spacing: 10;

               Box {
                 orientation: horizontal;
                 spacing: 10;
                 margin-start: 8;
                 margin-end: 8;
               
                 Label {
                   styles [
                     "title-1",
                   ]
                   label: _("Trending");
                   xalign: 0.0;
                   hexpand: true;
                 }
               }
             
               $BzDynamicListView {
                 styles [
                   "flathub-page-section",
                 ]
               
                 hexpand: true;
               
                 scroll: false;
                 noscroll-kind: flow-box;
                 child-type: "BzAppTile";
                 child-prop: "group";
                 model: SliceListModel {
                   offset: 0;
                   size: 12;
                   model: bind template.state as <$BzFlathubState>.trending;
                 };
               
                 bind-widget => $bind_widget_cb(template);      
                 unbind-widget => $unbind_widget_cb(template);      
               }
               Button {
                  styles [
                  "pill"
                  ]

                   label: _("More Trending");
                   halign: center;
                   valign: center;
                   clicked => $show_more_trending_clicked_cb(template);
                }
             }

             Box {
               orientation: vertical;
               spacing: 10;

               Label {
                 margin-start: 8;
                 styles [
                   "title-1",
                 ]
                 label: _("Categories");
                 xalign: 0.0;
                 hexpand: true;
               }
             
               $BzDynamicListView {
                 styles [
                   "flathub-page-section",
                 ]
               
                 hexpand: true;
                 max-children-per-line:5;
                 scroll: false;
                 noscroll-kind: flow-box;
                 child-type: "BzCategoryTile";
                 child-prop: "category";
                 model: bind template.state as <$BzFlathubState>.categories;
               
                 bind-widget => $bind_category_tile_cb(template);
                 unbind-widget => $unbind_category_tile_cb(template);
               }
             }

             Box {
               orientation: vertical;
               spacing: 10;
             
               Box {
                 orientation: horizontal;
                 spacing: 10;
                 margin-start: 8;
                 margin-end: 8;
               
                 Label {
                   styles [
                     "title-1",
                   ]
                   label: _("Recently Updated");
                   xalign: 0.0;
                   hexpand: true;
                 }
               }
             
               $BzDynamicListView {
                 styles [
                   "flathub-page-section",
                 ]
               
                 hexpand: true;
               
                 scroll: false;
                 noscroll-kind: flow-box;
                 child-type: "BzAppTile";
                 child-prop: "group";
                 model: SliceListModel {
                   offset: 0;
                   size: 12;
                   model: bind template.state as <$BzFlathubState>.recently_updated;
                 };
               
                 bind-widget => $bind_widget_cb(template);      
                 unbind-widget => $unbind_widget_cb(template);      
               }
               Button {
                  styles [
                  "pill"
                  ]

                   label: _("More Recently Updated");
                   halign: center;
                   valign: center;
                   clicked => $show_more_recently_updated_clicked_cb(template);
               }
             }

             Box {
               orientation: vertical;
               spacing: 10;
             
               Box {
                 orientation: horizontal;
                 spacing: 10;
                 margin-start: 8;
                 margin-end: 8;
               
                 Label {
                   styles [
                     "title-1",
                   ]
                   label: _("Recently Added");
                   xalign: 0.0;
                   hexpand: true;
                 }
               }
             
               $BzDynamicListView {
                 styles [
                   "flathub-page-section",
                 ]
               
                 hexpand: true;
               
                 scroll: false;
                 noscroll-kind: flow-box;
                 child-type: "BzAppTile";
                 child-prop: "group";
                 model: SliceListModel {
                   offset: 0;
                   size: 12;
                   model: bind template.state as <$BzFlathubState>.recently_added;
                 };
               
                 bind-widget => $bind_widget_cb(template);      
                 unbind-widget => $unbind_widget_cb(template);      
               }
               Button {
                  styles [
                  "pill"
                  ]

                   label: _("More Recently Added");
                   halign: center;
                   valign: center;
                   clicked => $show_more_recently_added_clicked_cb(template);
               }
             }
           
             Box {
               orientation: vertical;
               spacing: 10;
             
               Box {
                 orientation: horizontal;
                 spacing: 10;
                 margin-start: 8;
                 margin-end: 8;
               
                 Label {
                   styles [
                     "title-1",
                   ]
                   label: _("Popular");
                   xalign: 0.0;
                   hexpand: true;
                 }
               }
             
               $BzDynamicListView {
                 styles [
                   "flathub-page-section",
                 ]
               
                 hexpand: true;
               
                 scroll: false;
                 noscroll-kind: flow-box;
                 child-type: "BzAppTile";
                 child-prop: "group";
                 model: SliceListModel {
                   offset: 0;
                   size: 12;
                   model: bind template.state as <$BzFlathubState>.popular;
                 };
               
                 bind-widget => $bind_widget_cb(template);      
                 unbind-widget => $unbind_widget_cb(template);      
               }
               Button {
                  styles [
                  "pill"
                  ]

                   label: _("More Popular");
                   halign: center;
                   valign: center;
                   clicked => $show_more_popular_clicked_cb(template);
               }
             }
           };
         };
       };
     };
   }
 };
}